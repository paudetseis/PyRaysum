<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Classes &mdash; pyraysum 1.0.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Example 1: Compare PyRaysum with other synthetic and real data" href="tutorials/1/1_make_seismograms.html" />
    <link rel="prev" title="Licence" href="init.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            pyraysum
              <img src="_static/PyRaysum_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Quick Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="links.html">GitHub Repository</a></li>
<li class="toctree-l1"><a class="reference internal" href="links.html#references">References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="init.html">Licence</a></li>
<li class="toctree-l1"><a class="reference internal" href="init.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="init.html#usage">Usage</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Classes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#model">Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyraysum.prs.Model"><code class="docutils literal notranslate"><span class="pre">Model</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyraysum.prs.Model.update"><code class="docutils literal notranslate"><span class="pre">Model.update()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyraysum.prs.Model.copy"><code class="docutils literal notranslate"><span class="pre">Model.copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyraysum.prs.Model.change"><code class="docutils literal notranslate"><span class="pre">Model.change()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyraysum.prs.Model.split_layer"><code class="docutils literal notranslate"><span class="pre">Model.split_layer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyraysum.prs.Model.remove_layer"><code class="docutils literal notranslate"><span class="pre">Model.remove_layer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyraysum.prs.Model.average_layers"><code class="docutils literal notranslate"><span class="pre">Model.average_layers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyraysum.prs.Model.save"><code class="docutils literal notranslate"><span class="pre">Model.save()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyraysum.prs.Model.write"><code class="docutils literal notranslate"><span class="pre">Model.write()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyraysum.prs.Model.plot"><code class="docutils literal notranslate"><span class="pre">Model.plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyraysum.prs.Model.plot_profile"><code class="docutils literal notranslate"><span class="pre">Model.plot_profile()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyraysum.prs.Model.plot_layers"><code class="docutils literal notranslate"><span class="pre">Model.plot_layers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyraysum.prs.Model.plot_interfaces"><code class="docutils literal notranslate"><span class="pre">Model.plot_interfaces()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#geometry">Geometry</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyraysum.prs.Geometry"><code class="docutils literal notranslate"><span class="pre">Geometry</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyraysum.prs.Geometry.copy"><code class="docutils literal notranslate"><span class="pre">Geometry.copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyraysum.prs.Geometry.save"><code class="docutils literal notranslate"><span class="pre">Geometry.save()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyraysum.prs.Geometry.write"><code class="docutils literal notranslate"><span class="pre">Geometry.write()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyraysum.prs.Geometry.plot"><code class="docutils literal notranslate"><span class="pre">Geometry.plot()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#control">Control</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyraysum.prs.Control"><code class="docutils literal notranslate"><span class="pre">Control</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyraysum.prs.Control.parameters"><code class="docutils literal notranslate"><span class="pre">Control.parameters</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyraysum.prs.Control.set_phaselist"><code class="docutils literal notranslate"><span class="pre">Control.set_phaselist()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyraysum.prs.Control.null_phaselist"><code class="docutils literal notranslate"><span class="pre">Control.null_phaselist()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyraysum.prs.Control.save"><code class="docutils literal notranslate"><span class="pre">Control.save()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyraysum.prs.Control.write"><code class="docutils literal notranslate"><span class="pre">Control.write()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#result">Result</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyraysum.prs.Result"><code class="docutils literal notranslate"><span class="pre">Result</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyraysum.prs.Result.calculate_rfs"><code class="docutils literal notranslate"><span class="pre">Result.calculate_rfs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyraysum.prs.Result.descriptors"><code class="docutils literal notranslate"><span class="pre">Result.descriptors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyraysum.prs.Result.write"><code class="docutils literal notranslate"><span class="pre">Result.write()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyraysum.prs.Result.plot"><code class="docutils literal notranslate"><span class="pre">Result.plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyraysum.prs.Result.filter"><code class="docutils literal notranslate"><span class="pre">Result.filter()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#modules">Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pyraysum.prs">Module <code class="xref py py-mod docutils literal notranslate"><span class="pre">prs</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyraysum.prs.run"><code class="docutils literal notranslate"><span class="pre">run()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyraysum.prs.read_model"><code class="docutils literal notranslate"><span class="pre">read_model()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyraysum.prs.read_geometry"><code class="docutils literal notranslate"><span class="pre">read_geometry()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyraysum.prs.read_control"><code class="docutils literal notranslate"><span class="pre">read_control()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyraysum.prs.equivalent_phases"><code class="docutils literal notranslate"><span class="pre">equivalent_phases()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyraysum.frs">Module <code class="xref py py-mod docutils literal notranslate"><span class="pre">frs</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyraysum.frs.read_traces"><code class="docutils literal notranslate"><span class="pre">read_traces()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyraysum.frs.read_arrivals"><code class="docutils literal notranslate"><span class="pre">read_arrivals()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyraysum.frs.make_array"><code class="docutils literal notranslate"><span class="pre">make_array()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyraysum.frs.filtered_rf_array"><code class="docutils literal notranslate"><span class="pre">filtered_rf_array()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyraysum.frs.filtered_array"><code class="docutils literal notranslate"><span class="pre">filtered_array()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyraysum.plot">Module <code class="xref py py-mod docutils literal notranslate"><span class="pre">plot</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyraysum.plot.stack_all"><code class="docutils literal notranslate"><span class="pre">stack_all()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyraysum.plot.rf_wiggles"><code class="docutils literal notranslate"><span class="pre">rf_wiggles()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyraysum.plot.stream_wiggles"><code class="docutils literal notranslate"><span class="pre">stream_wiggles()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyraysum.plot.seis_wiggles"><code class="docutils literal notranslate"><span class="pre">seis_wiggles()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-fraysum">Module <code class="xref py py-mod docutils literal notranslate"><span class="pre">fraysum</span></code></a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials/1/1_make_seismograms.html">Example 1: Compare PyRaysum with other synthetic and real data</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/2/2_reproduce_Porter-2011.html">Example 2: Reproducing Receiver Functions for Dipping and Anisotropic Subsurface Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/3/3_invert_rf.html">Example 3: Invert a Receiver Function</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Jupyter Notebooks</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://nbviewer.jupyter.org/github/paudetseis/PyRaysum/blob/main/pyraysum/examples/notebooks/1_make_seismograms.ipynb">Example 1: Compare PyRaysum with other synthetic and real data</a></li>
<li class="toctree-l1"><a class="reference external" href="https://nbviewer.jupyter.org/github/paudetseis/PyRaysum/blob/main/pyraysum/examples/notebooks/2_reproduce_Porter-2011.ipynb">Example 2: Reproducing Figure 2 in Porter et al. (2011)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://nbviewer.jupyter.org/github/paudetseis/PyRaysum/blob/main/pyraysum/examples/notebooks/3_invert_rf.ipynb">Example 3: Invert a receiver function</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyraysum</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Classes</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <figure class="align-center">
<img alt="_images/PyRaysum_logo.png" src="_images/PyRaysum_logo.png" />
</figure>
<p>Synthetic seismograms are computed from three classes: <code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code>,
<code class="xref py py-class docutils literal notranslate"><span class="pre">Geometry</span></code>, and <code class="xref py py-class docutils literal notranslate"><span class="pre">Control</span></code> using <code class="xref py py-func docutils literal notranslate"><span class="pre">prs.run()</span></code>, and are stored in
an instance of class <code class="xref py py-class docutils literal notranslate"><span class="pre">Result</span></code>.</p>
<section id="classes">
<h1>Classes<a class="headerlink" href="#classes" title="Permalink to this heading"></a></h1>
<p><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyraysum</span></code> defines the following classes:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#pyraysum.prs.Model" title="pyraysum.prs.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a></p></li>
<li><p><a class="reference internal" href="#pyraysum.prs.Geometry" title="pyraysum.prs.Geometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">Geometry</span></code></a></p></li>
<li><p><a class="reference internal" href="#pyraysum.prs.Result" title="pyraysum.prs.Result"><code class="xref py py-class docutils literal notranslate"><span class="pre">Result</span></code></a></p></li>
<li><p><a class="reference internal" href="#pyraysum.prs.Control" title="pyraysum.prs.Control"><code class="xref py py-class docutils literal notranslate"><span class="pre">Control</span></code></a></p></li>
</ul>
<section id="model">
<h2>Model<a class="headerlink" href="#model" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyraysum.prs.Model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyraysum.prs.</span></span><span class="sig-name descname"><span class="pre">Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thickn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ani</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plunge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strike</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vpvs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.73</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxlay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#Model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.Model" title="Permalink to this definition"></a></dt>
<dd><p>Model of the subsurface seismic velocity structure.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This object holds the infromation of the .mod file in classic Raysum</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thickn</strong> (<em>array_like</em>) – Thickness of layers (m)</p></li>
<li><p><strong>rho</strong> (<em>float</em><em> or </em><em>array_like</em>) – Density (kg/m^3)</p></li>
<li><p><strong>vp</strong> (<em>float</em><em> or </em><em>array_like</em>) – P-wave velocity (m/s)</p></li>
<li><p><strong>vs</strong> (<em>float</em><em> or </em><em>array_like</em><em>, </em><em>optional</em>) – S-wave velocity (m/s)
If None, computed from <code class="xref py py-const docutils literal notranslate"><span class="pre">vpvs</span></code></p></li>
<li><p><strong>flag</strong> (<em>array_like</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – <code class="xref py py-const docutils literal notranslate"><span class="pre">1</span></code> for isotropic, <code class="xref py py-const docutils literal notranslate"><span class="pre">0</span></code> for anisotropic</p></li>
<li><p><strong>ani</strong> (<em>float</em><em> or </em><em>array_like</em><em>, </em><em>optional</em>) – Anisotropy (percent)</p></li>
<li><p><strong>trend</strong> (<em>float</em><em> or </em><em>array_like</em><em>, </em><em>optional</em>) – Trend of symmetry axis (degree)</p></li>
<li><p><strong>plunge</strong> (<em>float</em><em> or </em><em>array_like</em><em>, </em><em>optional</em>) – Plunge of symmetry axis (degree)</p></li>
<li><p><strong>strike</strong> (<em>float</em><em> or </em><em>array_like</em><em>, </em><em>optional</em>) – azimuth of interface in RHR (degree clockwise from north)</p></li>
<li><p><strong>dip</strong> (<em>float</em><em> or </em><em>array_like</em><em>, </em><em>optional</em>) – dip of interface in RHR (degree down from horizontal)</p></li>
<li><p><strong>vpvs</strong> (<em>float</em><em> or </em><em>array_like</em><em>, </em><em>optional</em>) – P-to-S velocity ratio.
Defaults to 1.73. Ignored if <code class="xref py py-const docutils literal notranslate"><span class="pre">vs</span></code> is set.</p></li>
<li><p><strong>maxlay</strong> (<em>int</em>) – Maximum number of layers defined in params.h</p></li>
</ul>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When setting <cite>vpvs</cite>, <cite>vs</cite> is adjusted to satisfy vs = vp / vpvs.</p>
</div>
<p>The following attributes are set upon initialization, when setting a layer property
via <code class="xref py py-meth docutils literal notranslate"><span class="pre">Model.__setitem__()</span></code> (i.e. <code class="xref py py-attr docutils literal notranslate"><span class="pre">model[0]</span></code> or <code class="xref py py-attr docutils literal notranslate"><span class="pre">model[0,</span>
<span class="pre">&quot;thickn&quot;]</span></code>), and when execuding <a class="reference internal" href="#pyraysum.prs.Model.update" title="pyraysum.prs.Model.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Model.update()</span></code></a> after setting a single
element of the above model attributes. <cite>f</cite> prefixes indicate attributes used for
interaction with <cite>fraysum.run_bare()</cite> and <cite>fraysum.run_full()</cite>. Set these directly
for best performance.</p>
<blockquote>
<div><dl class="simple">
<dt>nlay</dt><dd><p>Number of layers</p>
</dd>
<dt>parameters</dt><dd><p>Convenience attribute that collects the <cite>f</cite>-attributes in the order expected
by <cite>fraysum.run_bare()</cite> and <cite>fraysum.run_full()</cite></p>
</dd>
<dt>fthickn</dt><dd><p>Thickness of layers (m)</p>
</dd>
<dt>frho</dt><dd><p>Density (kg/m^3)</p>
</dd>
<dt>fvp</dt><dd><p>P-wave velocity (m/s)</p>
</dd>
<dt>fvs</dt><dd><p>S-wave velocity (m/s)</p>
</dd>
<dt>fflag</dt><dd><p>Flag indicating isotropy (1) or anisotropy (0) of layer material</p>
</dd>
<dt>fani</dt><dd><p>Anisotropy (percent)</p>
</dd>
<dt>ftrend</dt><dd><p>Trend of symmetry axis (radians)</p>
</dd>
<dt>fplunge</dt><dd><p>Plunge of symmetry axis (radians)</p>
</dd>
<dt>fstrike</dt><dd><p>azimuth of interface in RHR (radians)</p>
</dd>
<dt>fdip</dt><dd><p>dip of interface in RHR (radians)</p>
</dd>
</dl>
</div></blockquote>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyraysum</span> <span class="kn">import</span> <span class="n">Model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">([</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3000</span><span class="p">,</span> <span class="mi">4500</span><span class="p">],</span> <span class="p">[</span><span class="mi">6000</span><span class="p">,</span> <span class="mi">8000</span><span class="p">],</span> <span class="p">[</span><span class="mi">3500</span><span class="p">,</span> <span class="mi">4600</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="go">#  thickn     rho      vp      vs  flag aniso   trend plunge strike   dip</span>
<span class="go">  10000.0  3000.0  6000.0  3500.0    1    0.0     0.0    0.0    0.0   0.0</span>
<span class="go">      0.0  4500.0  8000.0  4600.0    1    0.0     0.0    0.0    0.0   0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;thickn&quot;</span><span class="p">]</span>
<span class="go">10000.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">thickn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">10000.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">thickn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">15000</span>  <span class="c1"># model.fthickn has not yet changed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>  <span class="c1"># Now everything works as expected</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fthickn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">15000.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;vp&quot;</span><span class="p">]</span>
<span class="go">8000.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;vp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">7400.</span>  <span class="c1"># Does not require model.update()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;vp&quot;</span><span class="p">]</span>
<span class="go">7400.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;vs&quot;</span><span class="p">:</span> <span class="mf">4200.</span><span class="p">,</span> <span class="s2">&quot;rho&quot;</span><span class="p">:</span> <span class="mf">4000.</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;vs&quot;</span><span class="p">]</span>
<span class="go">4200.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;rho&quot;</span><span class="p">]</span>
<span class="go">4000.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;thickn&quot;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span> <span class="s2">&quot;vp&quot;</span><span class="p">:</span> <span class="mf">8000.</span><span class="p">,</span> <span class="s2">&quot;vpvs&quot;</span><span class="p">:</span> <span class="mf">2.</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;vs&quot;</span><span class="p">]</span>
<span class="go">4000.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">+=</span> <span class="p">[</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">3600</span><span class="p">,</span> <span class="mi">8000</span><span class="p">,</span> <span class="mi">4000</span><span class="p">]</span>  <span class="c1"># thickn, rho, vp, vs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="go">#  thickn     rho      vp      vs  flag aniso   trend plunge strike   dip</span>
<span class="go">  15000.0  3000.0  6000.0  3500.0    1    0.0     0.0    0.0    0.0   0.0</span>
<span class="go">   5000.0  4000.0  8000.0  4000.0    1    0.0     0.0    0.0    0.0   0.0</span>
<span class="go">   5000.0  3600.0  8000.0  4000.0    1    0.0     0.0    0.0    0.0   0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">+=</span> <span class="p">{</span><span class="s2">&quot;thickn&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;rho&quot;</span><span class="p">:</span> <span class="mi">3800</span><span class="p">,</span> <span class="s2">&quot;vp&quot;</span><span class="p">:</span> <span class="mf">8500.</span><span class="p">,</span> <span class="s2">&quot;dip&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s2">&quot;strike&quot;</span><span class="p">:</span> <span class="mi">90</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="go">#  thickn     rho      vp      vs  flag aniso   trend plunge strike   dip</span>
<span class="go">  15000.0  3000.0  6000.0  3500.0    1    0.0     0.0    0.0    0.0   0.0</span>
<span class="go">   5000.0  4000.0  8000.0  4000.0    1    0.0     0.0    0.0    0.0   0.0</span>
<span class="go">   5000.0  3600.0  8000.0  4000.0    1    0.0     0.0    0.0    0.0   0.0</span>
<span class="go">      0.0  3800.0  8500.0  4913.3    1    0.0     0.0    0.0   90.0  20.0</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pyraysum.prs.Model.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">change</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vpvs'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#Model.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.Model.update" title="Permalink to this definition"></a></dt>
<dd><p>Update all attributes after one of them was changed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>change</strong> (<em>str</em>) – <p>Decide which of <code class="xref py py-attr docutils literal notranslate"><span class="pre">vp</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">vs</span></code> or <code class="xref py py-attr docutils literal notranslate"><span class="pre">vpvs</span></code> should
depend on the other two:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>’vpvs’</cite>: Calculate <code class="xref py py-attr docutils literal notranslate"><span class="pre">vpvs</span></code> from <cite>vpvs = vp / vs</cite></p></li>
<li><p><cite>’vp’</cite>: Calculate <code class="xref py py-attr docutils literal notranslate"><span class="pre">vp</span></code> from <cite>vp = vs * vpvs</cite></p></li>
<li><p><cite>’vs’</cite>: Calculate <code class="xref py py-attr docutils literal notranslate"><span class="pre">vs</span></code> from <cite>vs = vp / vpvs</cite></p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyraysum.prs.Model.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#Model.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.Model.copy" title="Permalink to this definition"></a></dt>
<dd><p>Return a copy of the model</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyraysum.prs.Model.change">
<span class="sig-name descname"><span class="pre">change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">command</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#Model.change"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.Model.change" title="Permalink to this definition"></a></dt>
<dd><p>Change layer properties using a command string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>command</strong> (<em>str</em>) – An arbitrary number of command substrings separated by ‘;’</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Print changed parameters to screen</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of changes applied of the form:
(attribute, layer, new value)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of 3*tuple</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the <code class="xref py py-data docutils literal notranslate"><span class="pre">command</span></code> argument, each substring has the form:</p>
<p>KEY LAYER SIGN VAL;</p>
<p>where</p>
<p>KEY [t|vp|vs|psp|pss|s|d|a|tr|pl] is the attribute to change</p>
<blockquote>
<div><ul class="simple">
<li><p>t: thickness (km)</p></li>
<li><p>vp: P wave velocity (km/s)</p></li>
<li><p>vs: S wave velocity (km/s)</p></li>
<li><p>psp: P to S wave velocity ratio with fixed vs (changing vp)</p></li>
<li><p>pss: P to S wave velocity ratio with fixed vp (changing vs)</p></li>
<li><p>s: strike (degree)</p></li>
<li><p>d: dip (degree)</p></li>
<li><p>a: anisotropy (%)</p></li>
<li><p>tr: trend of the anisotropy axis (degree)</p></li>
<li><p>pl: plunge ot the anisotropy axis (degree)</p></li>
</ul>
</div></blockquote>
<p>LAYER (int) is the index of the layer</p>
<p>SIGN [=|+|-] is to set / increase / decrease the attribute</p>
<p>VAL (float) is the value to set / increase / decrease</p>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>For example, <code class="docutils literal notranslate"><span class="pre">Model.change('t0+10;psp0-0.2;d1+5;s1=45')</span></code> does:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Increase the thickness of the first layer by 10 km</p></li>
<li><p>Decrease Vp/Vs of the of the first layer by 0.2, holding Vs
fixed</p></li>
<li><p>Increase the dip of the second layer by 5 degree</p></li>
<li><p>Set the strike of the second layer to 45 degree</p></li>
</ol>
</div></blockquote>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyraysum.prs.Model.split_layer">
<span class="sig-name descname"><span class="pre">split_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#Model.split_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.Model.split_layer" title="Permalink to this definition"></a></dt>
<dd><p>Split layer <cite>n</cite> into two with half the thickness each, but otherwise
identical parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n</strong> – (int)
Index of the layer to split</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyraysum.prs.Model.remove_layer">
<span class="sig-name descname"><span class="pre">remove_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#Model.remove_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.Model.remove_layer" title="Permalink to this definition"></a></dt>
<dd><p>Remove layer <cite>n</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n</strong> (<em>int</em>) – Index of the layer to remove</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyraysum.prs.Model.average_layers">
<span class="sig-name descname"><span class="pre">average_layers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">top</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bottom</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#Model.average_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.Model.average_layers" title="Permalink to this definition"></a></dt>
<dd><p>Combine layers between top and bottom indices into one with summed
thicknesses and averaged vp, vs, and rho.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>top</strong> (<em>int</em>) – Index before top-most layer to include in combination</p></li>
<li><p><strong>bottom</strong> (<em>int</em>) – Index after bottom-most layer to include in combination</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>IndexError</strong> – if bottom is less or equal to top</p></li>
<li><p><strong>ValueError</strong> – if any layer is anisotropic</p></li>
<li><p><strong>ValueError</strong> – if any layer has a difference in strike or dip</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyraysum.prs.Model.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sample.mod'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prs'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#Model.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.Model.save" title="Permalink to this definition"></a></dt>
<dd><p>Alias for <a class="reference internal" href="#pyraysum.prs.Model.write" title="pyraysum.prs.Model.write"><code class="xref py py-class docutils literal notranslate"><span class="pre">write()</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyraysum.prs.Model.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sample.mod'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prs'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#Model.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.Model.write" title="Permalink to this definition"></a></dt>
<dd><p>Write seismic velocity model to disk as Raysum ASCII model file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> (<em>str</em>) – Name of the output file (including extension)</p></li>
<li><p><strong>comment</strong> (<em>str</em>) – String to write into file header</p></li>
<li><p><strong>hint</strong> (<em>bool</em>) – Include usage comment to model file</p></li>
<li><p><strong>version</strong> (<em>&quot;prs&quot;</em><em> or </em><em>&quot;raysum&quot;</em>) – Use PyRaysum or Raysum file format</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyraysum.prs.Model.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">75.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#Model.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.Model.plot" title="Permalink to this definition"></a></dt>
<dd><p>Plot model as stair case, layers and labeled interfaces, and show it</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>zmax</strong> (<em>float</em>) – Maximum depth of model to plot (km)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyraysum.prs.Model.plot_profile">
<span class="sig-name descname"><span class="pre">plot_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">75.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#Model.plot_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.Model.plot_profile" title="Permalink to this definition"></a></dt>
<dd><p>Plot model as stair case and show it</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zmax</strong> (<em>float</em>) – Maximum depth of model to plot (km)</p></li>
<li><p><strong>ax</strong> (<em>plt.axis</em>) – Axis handle for plotting. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, show the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Axis handle for plotting</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>plt.axis</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyraysum.prs.Model.plot_layers">
<span class="sig-name descname"><span class="pre">plot_layers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">75.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#Model.plot_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.Model.plot_layers" title="Permalink to this definition"></a></dt>
<dd><p>Plot model as horizontal layers and show it</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zmax</strong> (<em>float</em>) – Maximum depth of model to plot (km)</p></li>
<li><p><strong>ax</strong> (<em>plt.axis</em>) – Axis handle for plotting. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, show the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Axis handle for plotting</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>plt.axis</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyraysum.prs.Model.plot_interfaces">
<span class="sig-name descname"><span class="pre">plot_interfaces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['vp',</span> <span class="pre">'vs',</span> <span class="pre">'vpvs',</span> <span class="pre">'rho']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#Model.plot_interfaces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.Model.plot_interfaces" title="Permalink to this definition"></a></dt>
<dd><p>Plot model as labeled interfaces with possibly dipping layers</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zmax</strong> (<em>float</em>) – Maximum depth of model to plot (km)</p></li>
<li><p><strong>info</strong> (<em>list</em><em> of </em><em>str</em>) – Which <a class="reference internal" href="#pyraysum.prs.Model" title="pyraysum.prs.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> attributes to list for each layer</p></li>
<li><p><strong>ax</strong> (<em>plt.axis</em>) – Axis handle for plotting. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, show the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Axis handle for plotting</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>plt.axis</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If element in <code class="xref py py-const docutils literal notranslate"><span class="pre">info</span></code> is not recognized</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="geometry">
<h2>Geometry<a class="headerlink" href="#geometry" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyraysum.prs.Geometry">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyraysum.prs.</span></span><span class="sig-name descname"><span class="pre">Geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">baz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slow</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">de</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxtr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#Geometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.Geometry" title="Permalink to this definition"></a></dt>
<dd><p>Ray geometry of seismic events and station configuration.</p>
<p>One set of synthetic traces will be computed for each array element.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This object holds the infromation of the .geom file in classic Raysum</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>baz</strong> (<em>float</em><em> or </em><em>array_like</em>) – Ray back-azimuths (deg)</p></li>
<li><p><strong>slow</strong> (<em>float</em><em> or </em><em>array_like</em>) – Ray slownesses (s/km)</p></li>
<li><p><strong>dn</strong> (<em>float</em>) – North-offset of the seismic station (m)</p></li>
<li><p><strong>de</strong> (<em>float</em>) – East-offset of the seismic station (m)</p></li>
<li><p><strong>maxtr</strong> (<em>int</em>) – Maximum number of traces defined in params.h</p></li>
</ul>
</dd>
</dl>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>If <code class="xref py py-attr docutils literal notranslate"><span class="pre">baz</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">slow</span></code> do not have a different length, one ray will
be computed for each <em>combination</em> of <code class="xref py py-attr docutils literal notranslate"><span class="pre">baz</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">slow</span></code> (See examples)</p>
</div>
<p>The following attributes are set upon initialization. <cite>f</cite> prefixes indicate
attributes used for interaction with <cite>fraysum.run_bare()</cite> and
<cite>fraysum.run_full()</cite>.</p>
<blockquote>
<div><dl class="simple">
<dt>ntr (int):</dt><dd><p>Number of traces</p>
</dd>
<dt>parameters (list):</dt><dd><p>Convenience attribute that collects the <cite>f</cite>-attributes in the order expected
by <cite>fraysum.run_bare()</cite> and <cite>fraysum.run_full()</cite></p>
</dd>
<dt>fbaz (np.ndarray):</dt><dd><p>Ray back-azimuth (radians)</p>
</dd>
<dt>fslow (np.ndarray):</dt><dd><p>Ray slowness (m/s)</p>
</dd>
<dt>fdn (np.ndarray):</dt><dd><p>North-offset of the seismic station (m)</p>
</dd>
<dt>fde (np.ndarray):</dt><dd><p>East-offset of the seismic station (m)</p>
</dd>
</dl>
</div></blockquote>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyraysum</span> <span class="kn">import</span> <span class="n">Geometry</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geom</span> <span class="o">=</span> <span class="n">Geometry</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">geom</span><span class="p">)</span>
<span class="go">#Back-azimuth, Slowness, N-offset, E-offset</span>
<span class="go">        60.00    0.0600      0.00      0.00</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geom</span> <span class="o">+=</span> <span class="p">[[</span><span class="mi">90</span><span class="p">,</span> <span class="mi">120</span><span class="p">],</span> <span class="mf">0.04</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">geom</span><span class="p">)</span>
<span class="go">#Back-azimuth, Slowness, N-offset, E-offset</span>
<span class="go">        60.00    0.0600      0.00      0.00</span>
<span class="go">        90.00    0.0400      0.00      0.00</span>
<span class="go">       120.00    0.0400      0.00      0.00</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geom</span> <span class="o">=</span> <span class="n">Geometry</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">90</span><span class="p">),</span> <span class="p">[</span><span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">],</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">35</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">geom</span><span class="p">)</span>
<span class="go">#Back-azimuth, Slowness, N-offset, E-offset</span>
<span class="go">         0.00    0.0400     10.00     35.00</span>
<span class="go">        90.00    0.0400     10.00     35.00</span>
<span class="go">       180.00    0.0400     10.00     35.00</span>
<span class="go">       270.00    0.0400     10.00     35.00</span>
<span class="go">         0.00    0.0800     10.00     35.00</span>
<span class="go">        90.00    0.0800     10.00     35.00</span>
<span class="go">       180.00    0.0800     10.00     35.00</span>
<span class="go">       270.00    0.0800     10.00     35.00</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pyraysum.prs.Geometry.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#Geometry.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.Geometry.copy" title="Permalink to this definition"></a></dt>
<dd><p>Return a copy of the geometry</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyraysum.prs.Geometry.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sample.geom'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#Geometry.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.Geometry.save" title="Permalink to this definition"></a></dt>
<dd><p>Alias for <a class="reference internal" href="#pyraysum.prs.Geometry.write" title="pyraysum.prs.Geometry.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write()</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyraysum.prs.Geometry.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sample.geom'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#Geometry.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.Geometry.write" title="Permalink to this definition"></a></dt>
<dd><p>Write ray geometry to disk as ascii file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fname</strong> (<em>str</em>) – Name of file</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyraysum.prs.Geometry.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#Geometry.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.Geometry.plot" title="Permalink to this definition"></a></dt>
<dd><p>Plot ray geometry in polar coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Axis handle for plotting</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>plt.axis</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="control">
<h2>Control<a class="headerlink" href="#control" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyraysum.prs.Control">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyraysum.prs.</span></span><span class="sig-name descname"><span class="pre">Control</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'P'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mults</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.025</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxseg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxtr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxsamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#Control"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.Control" title="Permalink to this definition"></a></dt>
<dd><p>Run Control parameters for <code class="xref py py-meth docutils literal notranslate"><span class="pre">prs.run()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wvtype</strong> (<em>str</em>) – Wave type of incoming wavefield (<code class="xref py py-const docutils literal notranslate"><span class="pre">'P'</span></code>, <code class="xref py py-const docutils literal notranslate"><span class="pre">'SV'</span></code>, or <code class="xref py py-const docutils literal notranslate"><span class="pre">'SH'</span></code>)</p></li>
<li><p><strong>mults</strong> (<em>int</em>) – <p>ID for calculating free surface multiples</p>
<blockquote>
<div><ul>
<li><p>0: no multiple</p></li>
<li><p>1: First interface multiples only</p></li>
<li><p>2: all first-order multiples (once reflected from the surface)</p></li>
<li><p>3: supply phases to be computed via <a class="reference internal" href="#pyraysum.prs.Control.set_phaselist" title="pyraysum.prs.Control.set_phaselist"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Control.set_phaselist()</span></code></a></p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>npts</strong> (<em>int</em>) – Number of samples in time series</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – Sampling interval in seconds</p></li>
<li><p><strong>align</strong> (<em>int</em>) – <p>ID for time alignment of seismograms</p>
<blockquote>
<div><ul>
<li><p>0 or “none”: do not align</p></li>
<li><p>1 or “P”: align at <cite>P</cite></p></li>
<li><p>2 or “SV”: align at <cite>SV</cite></p></li>
<li><p>3 or “SH”: align at <cite>SH</cite></p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>shift</strong> (<em>float</em><em> or </em><em>None</em>) – Time shift in seconds (positive shift moves seismograms
to greater lags). If <code class="docutils literal notranslate"><span class="pre">None</span></code>, set to <code class="xref py py-attr docutils literal notranslate"><span class="pre">dt</span></code>, to include direct wave when
<code class="xref py py-const docutils literal notranslate"><span class="pre">align</span></code> &gt; 0.</p></li>
<li><p><strong>rot</strong> (<em>int</em><em> or </em><em>str</em>) – <p>ID for rotation:</p>
<blockquote>
<div><ul>
<li><p>0 or “ZNE”: up, north, east [left-handed]</p></li>
<li><p>1 or “RTZ”: radial, transverse, down [positive towards source]</p></li>
<li><p>2 or “PVH”: P-, SH-, SV-polarization [positive in ray direction]</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em> or </em><em>bool</em>) – <p>Verbosity:</p>
<blockquote>
<div><ul>
<li><p><code class="xref py py-const docutils literal notranslate"><span class="pre">0</span></code> or <code class="xref py py-const docutils literal notranslate"><span class="pre">False</span></code>: silent</p></li>
<li><p><code class="xref py py-const docutils literal notranslate"><span class="pre">1</span></code> or <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>: verbose</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>maxseg</strong> (<em>int</em>) – Maximum number of segments per ray, as defined in param.h</p></li>
<li><p><strong>maxtr</strong> (<em>int</em>) – Maximum number of traces, as defined in param.h</p></li>
<li><p><strong>maxph</strong> (<em>int</em>) – Maximum number of phases per trace, as defined in param.h</p></li>
<li><p><strong>maxsamp</strong> (<em>int</em>) – Maximum number of samples per trace, as defined in param.h</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyraysum.prs.Control.parameters">
<span class="sig-name descname"><span class="pre">parameters</span></span><a class="headerlink" href="#pyraysum.prs.Control.parameters" title="Permalink to this definition"></a></dt>
<dd><p>Convenience attribute that collects the attributes in the order expected
by <code class="xref py py-meth docutils literal notranslate"><span class="pre">fraysum.run_bare()</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">fraysum.run_full()</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The option <code class="xref py py-const docutils literal notranslate"><span class="pre">rot=0</span></code> returns the left-handed ZNE coordinates (Z positive
up), conventionally used for seismometers. The internal Fortran rountines
(everything imported through <code class="xref py py-mod docutils literal notranslate"><span class="pre">fraysum</span></code>) return right-handed NEZ
coordinates (Z positive down).</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pyraysum.prs.Control.set_phaselist">
<span class="sig-name descname"><span class="pre">set_phaselist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">descriptors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equivalent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kinematic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#Control.set_phaselist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.Control.set_phaselist" title="Permalink to this definition"></a></dt>
<dd><p>Explicitly set phases to be calculated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>descriptors</strong> (<em>list</em><em> of </em><em>str</em>) – <p>List of phase descriptors, where each descriptor is a string of
consecutive PHASE SEGMENT pairs, where
PHASE is:</p>
<blockquote>
<div><ul>
<li><p>P upgoing P-wave</p></li>
<li><p>S upgoing fast S-wave</p></li>
<li><p>T upgoing slow S-wave</p></li>
<li><p>p downgoing P-wave</p></li>
<li><p>s downgoing fast S-wave</p></li>
<li><p>t downgoing slow S-wave</p></li>
</ul>
</div></blockquote>
<p>SEGMENT is the index of the model layer.</p>
</p></li>
<li><p><strong>equivalent</strong> (<em>bool</em>) – Augment phaselist by equivalent phases (e.g., <cite>‘1P0P0s0P’</cite>;
<cite>‘1P0S0p0P’</cite>)</p></li>
<li><p><strong>kinematic</strong> (<em>bool</em>) – Limit equivalent phases to those with same polarity as input phases</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>IndexError</strong> – If resulting phaselist is longer than <code class="xref py py-const docutils literal notranslate"><span class="pre">maxph</span></code>.</p>
</dd>
</dl>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>At every interface, S-wave energy split up into a slow and a fast S-wave,
<cite>S</cite> and <cite>T</cite>, regardless of layer anisotropy. Make sure to include all
contributions when setting a explicit phaselist. It is best to inspect the
output of <a class="reference internal" href="#pyraysum.prs.Result.descriptors" title="pyraysum.prs.Result.descriptors"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Result.descriptors()</span></code></a> of a previous run with
<code class="xref py py-attr docutils literal notranslate"><span class="pre">mults=2</span></code> for the ray combinations relevant for your problem.</p>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Using <code class="xref py py-const docutils literal notranslate"><span class="pre">equivalent=False</span></code> may produce incorrect amplitudes, because
contributions of equivalent phases may be missing. At the same time,
amplitudes are oftentimes correct within 10%. Using <code class="xref py py-const docutils literal notranslate"><span class="pre">equivalent=True</span></code>
may cause performance issues.</p>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>In a two layer model (index <cite>0</cite> is the topmost subsurface layer, index <cite>1</cite>
is the underlying half-space) the <code class="xref py py-const docutils literal notranslate"><span class="pre">descriptors</span></code> compute the phases:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">['1P0P']</span></code>: direct P-wave</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">['1P0S']</span></code>: P-to-S1 converted wave</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">['1P0T']</span></code>: P-to-S2 converted wave</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">['1P0P',</span> <span class="pre">'1P0S',</span> <span class="pre">'1P0T]</span></code>: direct P-wave and all P-to-S converted waves</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">['1P0P0s0S']</span></code>: P reflected s at the surface, reflected S at the top of the half-space</p></li>
</ul>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyraysum.prs.Result.descriptors" title="pyraysum.prs.Result.descriptors"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Result.descriptors()</span></code></a> returns all phases computed in a previous run.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyraysum.prs.equivalent_phases" title="pyraysum.prs.equivalent_phases"><code class="xref py py-meth docutils literal notranslate"><span class="pre">equivalent_phases()</span></code></a> outputs equivalent phases explicitly</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyraysum.prs.Control.null_phaselist">
<span class="sig-name descname"><span class="pre">null_phaselist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mults</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#Control.null_phaselist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.Control.null_phaselist" title="Permalink to this definition"></a></dt>
<dd><p>Do not use phaselist, but compute using <code class="xref py py-const docutils literal notranslate"><span class="pre">mults</span></code> keyword.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mults</strong> (<em>int</em>) – Set <code class="xref py py-attr docutils literal notranslate"><span class="pre">Control.mults</span></code> to this value.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyraysum.prs.Control.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'raysum-param'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prs'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#Control.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.Control.save" title="Permalink to this definition"></a></dt>
<dd><p>Alias for <a class="reference internal" href="#pyraysum.prs.Control.write" title="pyraysum.prs.Control.write"><code class="xref py py-class docutils literal notranslate"><span class="pre">write()</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyraysum.prs.Control.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'raysum-param'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prs'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#Control.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.Control.write" title="Permalink to this definition"></a></dt>
<dd><p>Write parameter file to disk</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> – (str)
Name of file</p></li>
<li><p><strong>version</strong> – (“prs” or “raysum”)
Pyraysum or Raysum raysum compatible</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="result">
<h2>Result<a class="headerlink" href="#result" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyraysum.prs.Result">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyraysum.prs.</span></span><span class="sig-name descname"><span class="pre">Result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geometry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">streams</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#Result"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.Result" title="Permalink to this definition"></a></dt>
<dd><p>Result of a PyRaysum wavefield simulation. 3-component synthetic seismograms
are strored as a list of streams in the stream attribute. Includes methods
to calculate receiver functions, filter and plot the results. See
<a class="reference internal" href="#pyraysum.prs.run" title="pyraysum.prs.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">run()</span></code></a> for examples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="#pyraysum.prs.Model" title="pyraysum.prs.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>) – Subsurface velocity model</p></li>
<li><p><strong>geometry</strong> (<a class="reference internal" href="#pyraysum.prs.Geometry" title="pyraysum.prs.Geometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">Geometry</span></code></a>) – Recording geometry</p></li>
<li><p><strong>rc</strong> (<a class="reference internal" href="#pyraysum.prs.Control" title="pyraysum.prs.Control"><code class="xref py py-class docutils literal notranslate"><span class="pre">Control</span></code></a>) – Run-control parameters</p></li>
<li><p><strong>streams</strong> (<em>list</em>) – List of <code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code> objects.</p></li>
</ul>
</dd>
</dl>
<p>If created with <code class="xref py py-const docutils literal notranslate"><span class="pre">mode='full'</span></code> in <a class="reference internal" href="#pyraysum.prs.run" title="pyraysum.prs.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code></a>, the <code class="xref py py-attr docutils literal notranslate"><span class="pre">stats</span></code> attribute
of each <code class="xref py py-class docutils literal notranslate"><span class="pre">Trace</span></code> in each <code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code> in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">Result.streams</span></code> holds the additional attributes:</p>
<blockquote>
<div><dl class="simple">
<dt>phase_times</dt><dd><p>Arrival times of seismic phases</p>
</dd>
<dt>phase_amplitudes</dt><dd><p>Amplitudes of seismic phases</p>
</dd>
<dt>phase_descriptors</dt><dd><p>Descriptors of seismic phases. Index indicates layer through which phase
propagates. (e.g. “1P0S”, see also <a class="reference internal" href="#pyraysum.prs.Result.descriptors" title="pyraysum.prs.Result.descriptors"><code class="xref py py-meth docutils literal notranslate"><span class="pre">descriptors()</span></code></a>)</p>
</dd>
<dt>phase_names</dt><dd><p>Short names of seismic phases (e.g. “PS”)</p>
</dd>
<dt>conversion_names</dt><dd><p>Conversion names of seismic phases. Index indicates top of layer at which
conversion occurs. (e.g. “P1S”)</p>
</dd>
</dl>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="pyraysum.prs.Result.calculate_rfs">
<span class="sig-name descname"><span class="pre">calculate_rfs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#Result.calculate_rfs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.Result.calculate_rfs" title="Permalink to this definition"></a></dt>
<dd><p>Generate receiver functions from spectral division of displacement traces.
Will be stored in <code class="xref py py-attr docutils literal notranslate"><span class="pre">rflist</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – In case <a class="reference internal" href="#pyraysum.prs.Control" title="pyraysum.prs.Control"><code class="xref py py-class docutils literal notranslate"><span class="pre">Control</span></code></a> parameters a unsuitable.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyraysum.prs.Result.descriptors">
<span class="sig-name descname"><span class="pre">descriptors</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#Result.descriptors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.Result.descriptors" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>list</dt><dd><p>Unique list of all phase descriptors present</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AttributeError</strong> – If no descriptors are present</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyraysum</span> <span class="kn">import</span> <span class="n">Model</span><span class="p">,</span> <span class="n">Control</span><span class="p">,</span> <span class="n">Geometry</span><span class="p">,</span> <span class="n">run</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">([</span><span class="mf">30000.</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">2800.</span><span class="p">,</span> <span class="mf">3300.</span><span class="p">],</span> <span class="p">[</span><span class="mf">6000.</span><span class="p">,</span> <span class="mf">8000.</span><span class="p">],</span> <span class="p">[</span><span class="mf">3600.</span><span class="p">,</span> <span class="mf">4500.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geom</span> <span class="o">=</span> <span class="n">Geometry</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rc</span> <span class="o">=</span> <span class="n">Control</span><span class="p">(</span><span class="n">mults</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seismogram</span> <span class="o">=</span> <span class="n">run</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">geom</span><span class="p">,</span> <span class="n">rc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seismogram</span><span class="o">.</span><span class="n">descriptors</span><span class="p">()</span>
<span class="go">[&#39;1P0P&#39;, &#39;1P0S&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyraysum.prs.Result.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sample.tr'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#Result.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.Result.write" title="Permalink to this definition"></a></dt>
<dd><p>Write streams to file, using legacy Raysum trace format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fname</strong> (<em>str</em>) – Name of the output file (including extension)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyraysum.prs.Result.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">typ</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#Result.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.Result.plot" title="Permalink to this definition"></a></dt>
<dd><p>Plot the displacement seismograms and/or receiver functions stored in
<a class="reference internal" href="#pyraysum.prs.Result" title="pyraysum.prs.Result"><code class="xref py py-class docutils literal notranslate"><span class="pre">Result</span></code></a> streams.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>typ</strong> (<em>str</em>) – Type of plot to show. Options are <code class="xref py py-const docutils literal notranslate"><span class="pre">'streams'</span></code>, <code class="xref py py-const docutils literal notranslate"><span class="pre">'rfs'</span></code>, or
<code class="xref py py-const docutils literal notranslate"><span class="pre">'all'</span></code> for the displacement seismograms, receiver functions, or
both</p></li>
<li><p><strong>**kwargs</strong> – Are passed to the underlying <a class="reference internal" href="#pyraysum.plot.stream_wiggles" title="pyraysum.plot.stream_wiggles"><code class="xref py py-meth docutils literal notranslate"><span class="pre">stream_wiggles()</span></code></a> or
<a class="reference internal" href="#pyraysum.plot.rf_wiggles" title="pyraysum.plot.rf_wiggles"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rf_wiggles()</span></code></a></p></li>
</ul>
</dd>
</dl>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>If <a class="reference internal" href="#pyraysum.prs.Result" title="pyraysum.prs.Result"><code class="xref py py-class docutils literal notranslate"><span class="pre">Result</span></code></a> contains only one event (i.e., single <code class="xref py py-attr docutils literal notranslate"><span class="pre">baz</span></code> and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">slow</span></code> values), it is more appropriate to plot the waveforms using the
default <code class="xref py py-meth docutils literal notranslate"><span class="pre">Stream.plot()</span></code> method on <code class="xref py py-attr docutils literal notranslate"><span class="pre">Result.streams[0]</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyraysum.prs.Result.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">typ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftype</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#Result.filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.Result.filter" title="Permalink to this definition"></a></dt>
<dd><p>Filters the displacement seismograms and/or receiver functions stored
in <a class="reference internal" href="#pyraysum.prs.Result" title="pyraysum.prs.Result"><code class="xref py py-class docutils literal notranslate"><span class="pre">Result</span></code></a> streams.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>typ</strong> (<em>str</em>) – Type of plot to show. Options are <code class="xref py py-const docutils literal notranslate"><span class="pre">'streams'</span></code>,
<code class="xref py py-const docutils literal notranslate"><span class="pre">'rfs'</span></code>, or <code class="xref py py-const docutils literal notranslate"><span class="pre">'all'</span></code> for the displacement seismograms,
receiver functions, or both</p></li>
<li><p><strong>ftype</strong> (<em>str</em>) – Type of filter to use in
<a class="reference external" href="https://tinyurl.com/45dkyvwy">obspy.Trace.filter</a></p></li>
<li><p><strong>**kwargs</strong> – <p>Keyword arguments passed to
<a class="reference external" href="https://tinyurl.com/45dkyvwy">obspy.Trace.filter</a></p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="modules">
<h1>Modules<a class="headerlink" href="#modules" title="Permalink to this heading"></a></h1>
<section id="module-pyraysum.prs">
<span id="module-prs"></span><h2>Module <code class="xref py py-mod docutils literal notranslate"><span class="pre">prs</span></code><a class="headerlink" href="#module-pyraysum.prs" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyraysum.prs.run">
<span class="sig-prename descclassname"><span class="pre">pyraysum.prs.</span></span><span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geometry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'full'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.run" title="Permalink to this definition"></a></dt>
<dd><p>Run a wave-field simulation. This function calls the compiled <code class="xref py py-mod docutils literal notranslate"><span class="pre">fraysum</span></code>
binaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="#pyraysum.prs.Model" title="pyraysum.prs.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>) – Subsurface velocity model</p></li>
<li><p><strong>geometry</strong> (<a class="reference internal" href="#pyraysum.prs.Geometry" title="pyraysum.prs.Geometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">Geometry</span></code></a>) – Recording geometry</p></li>
<li><p><strong>rc</strong> (<a class="reference internal" href="#pyraysum.prs.Control" title="pyraysum.prs.Control"><code class="xref py py-class docutils literal notranslate"><span class="pre">Control</span></code></a>) – Run-control parameters</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – <ul>
<li><p><code class="xref py py-const docutils literal notranslate"><span class="pre">'full'</span></code>: Compute seismograms, phase arrivals and descriptors (slower)</p></li>
<li><p><code class="xref py py-const docutils literal notranslate"><span class="pre">'bare'</span></code>: Only compute seismograms (faster)</p></li>
</ul>
</p></li>
<li><p><strong>rf</strong> (<em>bool</em>) – Whether or not to calculate receiver functions</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Synthetic seimograms</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#pyraysum.prs.Result" title="pyraysum.prs.Result"><code class="xref py py-class docutils literal notranslate"><span class="pre">Result</span></code></a></p>
</dd>
</dl>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Best performance is achived by calling <code class="xref py py-func docutils literal notranslate"><span class="pre">fraysum.run_bare()</span></code></p>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyraysum</span> <span class="kn">import</span> <span class="n">prs</span><span class="p">,</span> <span class="n">Model</span><span class="p">,</span> <span class="n">Geometry</span><span class="p">,</span> <span class="n">Control</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define two-layer model with isotropic crust over isotropic half-space</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">([</span><span class="mf">30000.</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">2800.</span><span class="p">,</span> <span class="mf">3300.</span><span class="p">],</span> <span class="p">[</span><span class="mf">6000.</span><span class="p">,</span> <span class="mf">8000.</span><span class="p">],</span> <span class="p">[</span><span class="mf">3600.</span><span class="p">,</span> <span class="mf">4500.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geom</span> <span class="o">=</span> <span class="n">Geometry</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">)</span> <span class="c1"># baz = 0 deg; slow = 0.06 s/km</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rc</span> <span class="o">=</span> <span class="n">Control</span><span class="p">(</span><span class="n">npts</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.025</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">prs</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">geom</span><span class="p">,</span> <span class="n">rc</span><span class="p">,</span> <span class="n">rf</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">streams</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">&lt;class &#39;obspy.core.stream.Stream&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">rfs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">&lt;class &#39;obspy.core.stream.Stream&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seis</span><span class="p">,</span> <span class="n">rf</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">seis</span><span class="p">)</span>
<span class="go">3 Trace(s) in Stream:</span>
<span class="go">...SYR | 1970-01-01T00:00:00.000000Z - 1970-01-01T00:00:37.475000Z | 40.0 Hz, 1500 samples</span>
<span class="go">...SYT | 1970-01-01T00:00:00.000000Z - 1970-01-01T00:00:37.475000Z | 40.0 Hz, 1500 samples</span>
<span class="go">...SYZ | 1970-01-01T00:00:00.000000Z - 1970-01-01T00:00:37.475000Z | 40.0 Hz, 1500 samples</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">rf</span><span class="p">)</span>
<span class="go">2 Trace(s) in Stream:</span>
<span class="go">...RFR | 1970-01-01T00:00:00.000000Z - 1970-01-01T00:00:37.475000Z | 40.0 Hz, 1500 samples</span>
<span class="go">...RFT | 1970-01-01T00:00:00.000000Z - 1970-01-01T00:00:37.475000Z | 40.0 Hz, 1500 samples</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyraysum.prs.read_model">
<span class="sig-prename descclassname"><span class="pre">pyraysum.prs.</span></span><span class="sig-name descname"><span class="pre">read_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prs'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#read_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.read_model" title="Permalink to this definition"></a></dt>
<dd><p>Reads model parameters from file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>version</strong> (<em>&quot;prs&quot;</em><em> or </em><em>&quot;raysum&quot;</em>) – File has PyRaysum or Raysum format</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Seismic velocity model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#pyraysum.prs.Model" title="pyraysum.prs.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyraysum.prs.read_geometry">
<span class="sig-prename descclassname"><span class="pre">pyraysum.prs.</span></span><span class="sig-name descname"><span class="pre">read_geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geomfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#read_geometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.read_geometry" title="Permalink to this definition"></a></dt>
<dd><p>Reads geometry parameters from file</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Ray geometry</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#pyraysum.prs.Geometry" title="pyraysum.prs.Geometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">Geometry</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyraysum.prs.read_control">
<span class="sig-prename descclassname"><span class="pre">pyraysum.prs.</span></span><span class="sig-name descname"><span class="pre">read_control</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">paramfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prs'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#read_control"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.read_control" title="Permalink to this definition"></a></dt>
<dd><p>Read Raysum run control parameters from file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>version</strong> – (“prs” or “raysum”)
File has PyRaysum or Raysum format</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Run control parameters</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#pyraysum.prs.Control" title="pyraysum.prs.Control"><code class="xref py py-class docutils literal notranslate"><span class="pre">Control</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyraysum.prs.equivalent_phases">
<span class="sig-prename descclassname"><span class="pre">pyraysum.prs.</span></span><span class="sig-name descname"><span class="pre">equivalent_phases</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">descriptors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kinematic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/prs.html#equivalent_phases"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.prs.equivalent_phases" title="Permalink to this definition"></a></dt>
<dd><p>Return descriptors of equivalent phases, i.e. those arriving at the same time as
the input phases</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>descriptors</strong> (<em>list</em><em> of </em><em>strings</em>) – Phase descriptors as in <a class="reference internal" href="#pyraysum.prs.Control.set_phaselist" title="pyraysum.prs.Control.set_phaselist"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Control.set_phaselist()</span></code></a></p></li>
<li><p><strong>kinematic</strong> (<em>boolean</em>) – If True, restrict to kinematically equivalent phases, i.e. those that have
the same polarization as input phases</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of unique descriptors of equivalent phases</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of strings</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyraysum</span> <span class="kn">import</span> <span class="n">prs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prs</span><span class="o">.</span><span class="n">equivalent_phases</span><span class="p">([</span><span class="s1">&#39;1P0P0p0S&#39;</span><span class="p">])</span>
<span class="go">[&#39;1P0P0s0P&#39;, &#39;1P0S0p0P&#39;]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pyraysum.frs">
<span id="module-frs"></span><h2>Module <code class="xref py py-mod docutils literal notranslate"><span class="pre">frs</span></code><a class="headerlink" href="#module-pyraysum.frs" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyraysum.frs.read_traces">
<span class="sig-prename descclassname"><span class="pre">pyraysum.frs.</span></span><span class="sig-name descname"><span class="pre">read_traces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traces</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geometry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arrivals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/frs.html#read_traces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.frs.read_traces" title="Permalink to this definition"></a></dt>
<dd><p>Create a <code class="xref py py-class docutils literal notranslate"><span class="pre">Result</span></code> from the array produced by <code class="xref py py-meth docutils literal notranslate"><span class="pre">fraysum.run_bare()</span></code>
and <code class="xref py py-meth docutils literal notranslate"><span class="pre">fraysum.run_full()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rc</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Control</span></code>) – Run-control parameters</p></li>
<li><p><strong>geometry</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Geometry</span></code>) – Ray parameters</p></li>
<li><p><strong>arrivals</strong> (<em>list</em>) – Output of <a class="reference internal" href="#pyraysum.frs.read_arrivals" title="pyraysum.frs.read_arrivals"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read_arrivals()</span></code></a>. List of arrival times, amplitudes, and
names</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of <code class="xref py py-class docutils literal notranslate"><span class="pre">obspy.Stream</span></code> objects</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyraysum.frs.read_arrivals">
<span class="sig-prename descclassname"><span class="pre">pyraysum.frs.</span></span><span class="sig-name descname"><span class="pre">read_arrivals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ttimes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitudes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phaselist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geometry</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/frs.html#read_arrivals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.frs.read_arrivals" title="Permalink to this definition"></a></dt>
<dd><p>Convert the <code class="xref py py-const docutils literal notranslate"><span class="pre">phaselist</span></code>, <code class="xref py py-const docutils literal notranslate"><span class="pre">amplitude</span></code> and <code class="xref py py-const docutils literal notranslate"><span class="pre">traveltime</span></code> output of
<code class="xref py py-meth docutils literal notranslate"><span class="pre">fraysum.run_full()</span></code> to lists of phase arrival times, amplitudes, long phase
descriptors, short phase names, and conversion names.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ttimes</strong> (<em>np.array</em>) – Travel time array …</p></li>
<li><p><strong>amplitudes</strong> (<em>np.array</em>) – Amplitude array …</p></li>
<li><p><strong>phaselist</strong> (<em>np.array</em>) – Phase identifier array returned by <code class="xref py py-func docutils literal notranslate"><span class="pre">fraysum.run_full()</span></code></p></li>
<li><p><strong>geometry</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">prs.Geometry</span></code>) – Ray geometry</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>3-component phase arrival lists, where indices translate to:</p>
<ul class="simple">
<li><p><code class="xref py py-const docutils literal notranslate"><span class="pre">0</span></code>: phase arrival times</p></li>
<li><p><code class="xref py py-const docutils literal notranslate"><span class="pre">1</span></code>: phase amplitudes</p></li>
<li><p><code class="xref py py-const docutils literal notranslate"><span class="pre">2</span></code>: (long) phase descriptors, e.g. “1P0S”</p></li>
<li><p><code class="xref py py-const docutils literal notranslate"><span class="pre">3</span></code>: (short) phase names, e.g. “PS”</p></li>
<li><p><code class="xref py py-const docutils literal notranslate"><span class="pre">4</span></code>: (intermediate) conversion names, e.g. “P1S”</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyraysum.frs.make_array">
<span class="sig-prename descclassname"><span class="pre">pyraysum.frs.</span></span><span class="sig-name descname"><span class="pre">make_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geometry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/frs.html#make_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.frs.make_array" title="Permalink to this definition"></a></dt>
<dd><p>Initialize array for <cite>NumPy</cite>-based post processing</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geometry</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">prs.Geometry</span></code>) – Recording geometry</p></li>
<li><p><strong>rc</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">prs.Control</span></code>) – Run-control parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array in shape to be used by <a class="reference internal" href="#pyraysum.frs.filtered_rf_array" title="pyraysum.frs.filtered_rf_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">filtered_rf_array()</span></code></a> and
<a class="reference internal" href="#pyraysum.frs.filtered_array" title="pyraysum.frs.filtered_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">filtered_array()</span></code></a>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-const docutils literal notranslate"><span class="pre">numpy.zeros((geometry.ntr,</span> <span class="pre">2,</span> <span class="pre">rc.npts))</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyraysum.frs.filtered_rf_array">
<span class="sig-prename descclassname"><span class="pre">pyraysum.frs.</span></span><span class="sig-name descname"><span class="pre">filtered_rf_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traces</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rfarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/frs.html#filtered_rf_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.frs.filtered_rf_array" title="Permalink to this definition"></a></dt>
<dd><p>Fast, <cite>NumPy</cite>-based, receiver function computation and filtering of
<code class="xref py py-meth docutils literal notranslate"><span class="pre">fraysum.run_bare()</span></code> output</p>
<p>Roughly equivalent to subsequent calls to <a class="reference internal" href="#pyraysum.frs.read_traces" title="pyraysum.frs.read_traces"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_traces()</span></code></a>,
<code class="xref py py-meth docutils literal notranslate"><span class="pre">Result.calculate_rfs()</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">Result.filter()</span></code>, stripped down
for computational efficiency, for use in inversion/probabilistic approaches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>traces</strong> (<em>np.ndarray</em>) – Output of <code class="xref py py-meth docutils literal notranslate"><span class="pre">fraysum.run_bare()</span></code></p></li>
<li><p><strong>rfarray</strong> (<em>np.ndarray</em>) – Initialized array of shape (ntr, 2, npts) to store output (See:
<a class="reference internal" href="#pyraysum.frs.make_array" title="pyraysum.frs.make_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_array()</span></code></a>)</p></li>
<li><p><strong>ntr</strong> (<em>int</em>) – Number of traces (<code class="xref py py-attr docutils literal notranslate"><span class="pre">Geometry.ntr</span></code>)</p></li>
<li><p><strong>npts</strong> (<em>int</em>) – Number of points per trace (<code class="xref py py-attr docutils literal notranslate"><span class="pre">Control.npts</span></code>)</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – Sampling interval (<code class="xref py py-attr docutils literal notranslate"><span class="pre">Control.dt</span></code>)</p></li>
<li><p><strong>fmin</strong> (<em>float</em>) – Lower bandpass frequency corner (Hz)</p></li>
<li><p><strong>fmax</strong> (<em>float</em>) – Upper bandpass frequency corner (Hz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None. Output is written to <code class="xref py py-const docutils literal notranslate"><span class="pre">rfarray</span></code></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Assumes PVH alignment (ray-polarization), i.e. <code class="xref py py-attr docutils literal notranslate"><span class="pre">Control.rot=&quot;PVH&quot;</span></code>.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyraysum.frs.filtered_array">
<span class="sig-prename descclassname"><span class="pre">pyraysum.frs.</span></span><span class="sig-name descname"><span class="pre">filtered_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traces</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rfarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/frs.html#filtered_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.frs.filtered_array" title="Permalink to this definition"></a></dt>
<dd><p>Fast, <cite>NumPy</cite>-based filtering of <code class="xref py py-meth docutils literal notranslate"><span class="pre">fraysum.run_bare()</span></code> output</p>
<p>Roughly equivalent to subsequent calls to <a class="reference internal" href="#pyraysum.frs.read_traces" title="pyraysum.frs.read_traces"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_traces()</span></code></a>, and
<code class="xref py py-meth docutils literal notranslate"><span class="pre">Result.filter()</span></code>, stripped down for computational efficiency,
for use in inversion/probabilistic approaches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>traces</strong> (<em>np.ndarray</em>) – Output of <code class="xref py py-meth docutils literal notranslate"><span class="pre">fraysum.run_bare()</span></code></p></li>
<li><p><strong>rfarray</strong> (<em>np.ndarray</em>) – Initialized array of shape (ntr, 2, npts) to store output (See:
<a class="reference internal" href="#pyraysum.frs.make_array" title="pyraysum.frs.make_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_array()</span></code></a>)</p></li>
<li><p><strong>ntr</strong> (<em>int</em>) – Number of traces (<code class="xref py py-attr docutils literal notranslate"><span class="pre">Geometry.ntr</span></code>)</p></li>
<li><p><strong>npts</strong> (<em>int</em>) – Number of points per trace (<code class="xref py py-attr docutils literal notranslate"><span class="pre">Control.npts</span></code>)</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – Sampling intervall (<code class="xref py py-attr docutils literal notranslate"><span class="pre">Control.dt</span></code>)</p></li>
<li><p><strong>fmin</strong> (<em>float</em>) – Lower bandpass frequency corner (Hz)</p></li>
<li><p><strong>fmax</strong> (<em>float</em>) – Upper bandpass frequency corner (Hz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None. Output is written to <code class="xref py py-const docutils literal notranslate"><span class="pre">rfarray</span></code></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Assumes PVH alignment (ray-polarization), i.e. <code class="xref py py-attr docutils literal notranslate"><span class="pre">Control.rot=&quot;PVH&quot;</span></code>.</p>
</div>
</dd></dl>

</section>
<section id="module-pyraysum.plot">
<span id="module-plot"></span><h2>Module <code class="xref py py-mod docutils literal notranslate"><span class="pre">plot</span></code><a class="headerlink" href="#module-pyraysum.plot" title="Permalink to this heading"></a></h2>
<p>Functions to plot single station displacement or receiver function seismograms.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyraysum.plot.stack_all">
<span class="sig-prename descclassname"><span class="pre">pyraysum.plot.</span></span><span class="sig-name descname"><span class="pre">stack_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pws</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/plot.html#stack_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.plot.stack_all" title="Permalink to this definition"></a></dt>
<dd><p>Stack all traces in <code class="docutils literal notranslate"><span class="pre">Stream</span></code> objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stream</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code>) – Contains traces to stack</p></li>
<li><p><strong>pws</strong> (<em>bool</em>) – Enables Phase-Weighted Stacking</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stacked trace</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Trace</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyraysum.plot.rf_wiggles">
<span class="sig-prename descclassname"><span class="pre">pyraysum.plot.</span></span><span class="sig-name descname"><span class="pre">rf_wiggles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rflist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">btyp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'baz'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'P'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pws</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'red'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'blue'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Figure_rf_wiggle'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'png'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'color':</span> <span class="pre">'black',</span> <span class="pre">'linewidth':</span> <span class="pre">0.1}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/plot.html#rf_wiggles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.plot.rf_wiggles" title="Permalink to this definition"></a></dt>
<dd><p>Plot receiver function seismograms sorted by back-azimuth or slowness.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rflist</strong> (<em>list</em><em> or </em><a class="reference internal" href="#pyraysum.prs.Result" title="pyraysum.prs.Result"><em>prs.Result</em></a>) – list of <a class="reference external" href="https://tinyurl.com/3u8dv8s8">obspy.core.Stream</a> objects
containing receiver functions</p></li>
<li><p><strong>btyp</strong> (<em>str</em>) – Type of sorting for panel</p></li>
<li><p><strong>wvtype</strong> (<em>str</em>) – Wavet type (‘P’, ‘SV’, or ‘SH’)</p></li>
<li><p><strong>pws</strong> (<em>bool</em>) – Enables Phase-Weighted Stacking</p></li>
<li><p><strong>tmin</strong> (<em>float</em>) – Lower bound of time axis (s)</p></li>
<li><p><strong>tmax</strong> (<em>float</em>) – Upper bound of time axis (s)</p></li>
<li><p><strong>scale</strong> (<em>float</em>) – Amplitude scaling factor</p></li>
<li><p><strong>save</strong> (<em>bool</em>) – Whether or not to save the figure</p></li>
<li><p><strong>axs</strong> (<em>4*tuple</em>) – <p>matplotlib axes to place the subplots.</p>
<blockquote>
<div><ul>
<li><p>axs[0]: radial stack</p></li>
<li><p>axs[1]: radial section</p></li>
<li><p>axs[2]: transverse stack</p></li>
<li><p>axs[3]: transverse section</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>pcolor</strong> (<em>str</em>) – Color to fill positive wiggles</p></li>
<li><p><strong>ncolor</strong> (<em>str</em>) – Color to fill negative wiggles</p></li>
<li><p><strong>ftitle</strong> (<em>str</em>) – Filename of figure to be saved (without format suffix, see fmt)</p></li>
<li><p><strong>fmt</strong> (<em>str</em>) – Output format (‘png’, ‘jpg’, or ‘eps’, etc.)</p></li>
<li><p><strong>plot_kwargs</strong> (<em>dict</em>) – Keyword arguments passed to
<a class="reference external" href="https://tinyurl.com/2p9xy7hs">matplotlib.pyplot.plot()</a></p></li>
<li><p><strong>figure</strong> (<em>dict</em>) – Keyword arguments passed to
<a class="reference external" href="https://tinyurl.com/yc3w956b">matplotlib.pyplot.figure()</a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Figure handle</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.pyplot.figure</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyraysum.plot.stream_wiggles">
<span class="sig-prename descclassname"><span class="pre">pyraysum.plot.</span></span><span class="sig-name descname"><span class="pre">stream_wiggles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">streamlist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">btyp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'baz'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'P'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'red'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'blue'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Figure_pw_wiggles'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'png'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'color':</span> <span class="pre">'black',</span> <span class="pre">'linewidth':</span> <span class="pre">0.1}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/plot.html#stream_wiggles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.plot.stream_wiggles" title="Permalink to this definition"></a></dt>
<dd><p>Plot displacement seismograms sorted by back-azimuth or slowness.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>streamlist</strong> (<em>list</em><em> or </em><a class="reference internal" href="#pyraysum.prs.Result" title="pyraysum.prs.Result"><em>prs.Result</em></a>) – <p>list of <a class="reference external" href="https://tinyurl.com/3u8dv8s8">obspy.core.Stream</a> objects
containing displacement seismograms</p>
</p></li>
<li><p><strong>btyp</strong> (<em>str</em>) – Type of sorting for panel</p></li>
<li><p><strong>wvtype</strong> (<em>str</em>) – Wave type (‘P’, ‘SV’, or ‘SH’)</p></li>
<li><p><strong>tmin</strong> (<em>float</em>) – Lower bound of time axis (s)</p></li>
<li><p><strong>tmax</strong> (<em>float</em>) – Upper bound of time axis (s)</p></li>
<li><p><strong>scale</strong> (<em>float</em>) – Scaling factor</p></li>
<li><p><strong>pcolor</strong> (<em>str</em>) – Color to fill positive wiggles</p></li>
<li><p><strong>ncolor</strong> (<em>str</em>) – Color to fill negative wiggles</p></li>
<li><p><strong>save</strong> (<em>bool</em>) – Whether or not to save the figure</p></li>
<li><p><strong>axs</strong> (<em>3*tuple</em>) – <p>matplotlib axes to place the subplots.</p>
<blockquote>
<div><ul>
<li><p>axs[0]: P or R section</p></li>
<li><p>axs[1]: V or T section</p></li>
<li><p>axs[2]: H or Z section</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>ftitle</strong> (<em>str</em>) – Filename of figure to be saved (without format suffix, see fmt)</p></li>
<li><p><strong>fmt</strong> (<em>str</em>) – Output format (‘png’, ‘jpg’, or ‘eps’, etc.)</p></li>
<li><p><strong>plot_kwargs</strong> (<em>dict</em>) – <p>Keyword arguments passed to
<a class="reference external" href="https://tinyurl.com/2p9xy7hs">matplotlib.pyplot.plot()</a></p>
</p></li>
<li><p><strong>figure</strong> (<em>dict</em>) – <p>Keyword arguments passed to
<a class="reference external" href="https://tinyurl.com/yc3w956b">matplotlib.pyplot.figure()</a></p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Figure handle</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.pyplot.figure</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyraysum.plot.seis_wiggles">
<span class="sig-prename descclassname"><span class="pre">pyraysum.plot.</span></span><span class="sig-name descname"><span class="pre">seis_wiggles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Figure_pw_wiggles_3c'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'png'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyraysum/plot.html#seis_wiggles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyraysum.plot.seis_wiggles" title="Permalink to this definition"></a></dt>
<dd><p>Plots 3-component wiggles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stream</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code>) – <p><a class="reference external" href="https://tinyurl.com/3u8dv8s8">obspy.core.Stream</a> containing 3 traces</p>
</p></li>
<li><p><strong>tmin</strong> (<em>float</em>) – Lower bound of time axis (s)</p></li>
<li><p><strong>tmax</strong> (<em>float</em><em>, </em><em>optional</em>) – Upper bound of time axis (s)</p></li>
<li><p><strong>save</strong> (<em>bool</em>) – Whether or not to save the figure</p></li>
<li><p><strong>ftitle</strong> (<em>str</em>) – Filename of figure to be saved (without format suffix, see fmt)</p></li>
<li><p><strong>fmt</strong> (<em>str</em>) – Output format (‘png’, ‘jpg’, or ‘eps’, etc.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Figure handle</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.pyplot.figure</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-fraysum">
<h2>Module <code class="xref py py-mod docutils literal notranslate"><span class="pre">fraysum</span></code><a class="headerlink" href="#module-fraysum" title="Permalink to this heading"></a></h2>
<p>These are the the access points to the low-level fortran routines.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The corresponding functions can be more succinctly called with the unpacked
lists of <code class="xref py py-attr docutils literal notranslate"><span class="pre">parameters</span></code>, like this:
<code class="docutils literal notranslate"><span class="pre">fraysum.run_bare(*model.parameters,</span> <span class="pre">*geometry.parameters,</span> <span class="pre">*rc.parameters)</span></code>.</p>
</div>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">tr_ph</span> <span class="pre">=</span> <span class="pre">fraysum.run_bare(thick,</span> <span class="pre">rho,</span> <span class="pre">alpha,</span> <span class="pre">beta,</span> <span class="pre">isoflag,</span> <span class="pre">pct,</span> <span class="pre">trend,plunge,</span> <span class="pre">strike,</span> <span class="pre">dip,</span> <span class="pre">nlay,</span> <span class="pre">baz,</span> <span class="pre">slow,</span> <span class="pre">sta_dx,</span> <span class="pre">sta_dy,</span> <span class="pre">ntr,</span> <span class="pre">iphase,</span> <span class="pre">mults,</span> <span class="pre">nsamp,dt,</span> <span class="pre">align,</span> <span class="pre">shift,</span> <span class="pre">out_rot,</span> <span class="pre">verb,</span> <span class="pre">nsegin,</span> <span class="pre">numphin,</span> <span class="pre">phaselistin)</span></span></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thick</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Model.fthickn</span></code></p></li>
<li><p><strong>rho</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Model.frho</span></code></p></li>
<li><p><strong>alpha</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Model.fvp</span></code></p></li>
<li><p><strong>beta</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Model.fvs</span></code></p></li>
<li><p><strong>isoflag</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Model.fflag</span></code></p></li>
<li><p><strong>pct</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Model.fani</span></code></p></li>
<li><p><strong>trend</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Model.ftrend</span></code></p></li>
<li><p><strong>plunge</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Model.fplunge</span></code></p></li>
<li><p><strong>strike</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Model.fstrike</span></code></p></li>
<li><p><strong>dip</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Model.fdip</span></code></p></li>
<li><p><strong>nlay</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Model.nlay</span></code></p></li>
<li><p><strong>baz</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Geometry.fbaz</span></code></p></li>
<li><p><strong>slow</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Geometry.fslow</span></code></p></li>
<li><p><strong>sta_dx</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Geometry.fdn</span></code></p></li>
<li><p><strong>sta_dy</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Geometry.fde</span></code></p></li>
<li><p><strong>ntr</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Geometry.ntr</span></code></p></li>
<li><p><strong>iphase</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Control.wvtype</span></code></p></li>
<li><p><strong>mults</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Control.mults</span></code></p></li>
<li><p><strong>nsamp</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Control.nsamp</span></code></p></li>
<li><p><strong>dt</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Control.dt</span></code></p></li>
<li><p><strong>align</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Control.align</span></code></p></li>
<li><p><strong>shift</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Control.shift</span></code></p></li>
<li><p><strong>out_rot</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Control.rot</span></code></p></li>
<li><p><strong>verb</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Control.verbose</span></code></p></li>
<li><p><strong>nsegin</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Control._nseg</span></code></p></li>
<li><p><strong>numphin</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Control._numph</span></code></p></li>
<li><p><strong>phaselistin</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Control.phaselist</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tr_ph</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>rank-3 array(‘f’) with bounds (3, <cite>maxsamp</cite>, <cite>maxtr</cite>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">tr_ph,</span> <span class="pre">travel_time,</span> <span class="pre">amplitudeout,</span> <span class="pre">phaselist</span> <span class="pre">=</span> <span class="pre">fraysum.run_full(thick,rho,</span> <span class="pre">alpha,</span> <span class="pre">beta,</span> <span class="pre">isoflag,</span> <span class="pre">pct,</span> <span class="pre">trend,</span> <span class="pre">plunge,</span> <span class="pre">strike,</span> <span class="pre">dip,</span> <span class="pre">nlay,</span> <span class="pre">baz,</span> <span class="pre">slow,sta_dx,</span> <span class="pre">sta_dy,</span> <span class="pre">ntr,</span> <span class="pre">iphase,</span> <span class="pre">mults,</span> <span class="pre">nsamp,</span> <span class="pre">dt,</span> <span class="pre">align,</span> <span class="pre">shift,</span> <span class="pre">out_rot,</span> <span class="pre">verb,</span> <span class="pre">nsegin,numphin,</span> <span class="pre">phaselistin)</span></span></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thick</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Model.fthickn</span></code></p></li>
<li><p><strong>rho</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Model.frho</span></code></p></li>
<li><p><strong>alpha</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Model.fvp</span></code></p></li>
<li><p><strong>beta</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Model.fvs</span></code></p></li>
<li><p><strong>isoflag</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Model.fflag</span></code></p></li>
<li><p><strong>pct</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Model.fani</span></code></p></li>
<li><p><strong>trend</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Model.ftrend</span></code></p></li>
<li><p><strong>plunge</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Model.fplunge</span></code></p></li>
<li><p><strong>strike</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Model.fstrike</span></code></p></li>
<li><p><strong>dip</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Model.fdip</span></code></p></li>
<li><p><strong>nlay</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Model.nlay</span></code></p></li>
<li><p><strong>baz</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Geometry.fbaz</span></code></p></li>
<li><p><strong>slow</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Geometry.fslow</span></code></p></li>
<li><p><strong>sta_dx</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Geometry.fdn</span></code></p></li>
<li><p><strong>sta_dy</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Geometry.fde</span></code></p></li>
<li><p><strong>ntr</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Geometry.ntr</span></code></p></li>
<li><p><strong>iphase</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Control.wvtype</span></code></p></li>
<li><p><strong>mults</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Control.mults</span></code></p></li>
<li><p><strong>nsamp</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Control.nsamp</span></code></p></li>
<li><p><strong>dt</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Control.dt</span></code></p></li>
<li><p><strong>align</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Control.align</span></code></p></li>
<li><p><strong>shift</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Control.shift</span></code></p></li>
<li><p><strong>out_rot</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Control.rot</span></code></p></li>
<li><p><strong>verb</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Control.verbose</span></code></p></li>
<li><p><strong>nsegin</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Control._nseg</span></code></p></li>
<li><p><strong>numphin</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Control._numph</span></code></p></li>
<li><p><strong>phaselistin</strong> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">Control.phaselist</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tr_ph</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>rank-3 array(‘f’) with bounds (3, <cite>maxsamp</cite>, <cite>maxtr</cite>):</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>travel_time</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>rank-2 array(‘f’) with bounds (<cite>maxph</cite>, <cite>maxtr</cite>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>amplitudeout</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>rank-3 array(‘f’) with bounds (3, <cite>maxph</cite>,`maxtr`)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>phaselist</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>rank-3 array(‘i’) with bounds (<cite>maxseg</cite>, 2, <cite>maxph</cite>)</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="init.html" class="btn btn-neutral float-left" title="Licence" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tutorials/1/1_make_seismograms.html" class="btn btn-neutral float-right" title="Example 1: Compare PyRaysum with other synthetic and real data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Wasja Bloch, Pascal Audet.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>